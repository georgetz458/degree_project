<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

    <meta charset="UTF-8">
    <title>Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/terraformer@1.0.8"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.1.2"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link href="/css/Style.css" rel="stylesheet">


</head>
<body style="text-align: center">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom border-light" >
    <div class="container-fluid">
        <a class="navbar-brand" href="/">Weather Analysis</a>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="/mainStats">Main</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" aria-current="page" href="/avgPerHour">Hourly</a>
                </li>
            </ul>
            <button class="btn btn-outline-light forGuest"  id="loginButton" style="display: none;">Login</button>
            <button class="btn btn-outline-light forAdmin"  id="logOutButton" style="display: none;">Logout</button>
        </div>
    </div>
</nav>
    <H1>Map of Municipalities with Available Weather Data</H1>
<br>
<br>
<h5>The municipalities are represented by highlighted shapes on the map.</h5>
<h5>Clicking on a shape will display a marker with a link to view the respective municipality's data.</h5>
<br>
    <div id="map" style="width: 50%; height: 500px; margin-left: auto; margin-right: auto;" ></div>

    <script th:inline="javascript">


        var map = L.map('map').setView([37.762970, 24.234984], 9);
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        }).addTo(map);

        var municipalities = [[${municipalities}]];

        for(let i=0; i<municipalities.length;i++){

            var municipalitiesCentroids = Terraformer.WKT.parse(municipalities[i].geomText);


            var geoJSON = L.geoJSON(municipalitiesCentroids).addTo(map);
            geoJSON.bindPopup("<a href='/perMunicipality?municipality="+municipalities[i].name+"'>Go to Municipality of "+municipalities[i].name+"</a>");
        }
    </script>
    <script type="module">
        import {} from '/js/FirebaseFunctions.js'
        import {} from '/js/MyFunctions.js'
    </script>
</body>
</html>